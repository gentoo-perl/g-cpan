language: perl
perl:
    - "5.22"
    - "5.20"
env:
    global:
        - DEV_TESTING=1
        - PERL_CPANM_OPT="--quiet --notest --skip-satisfied"
before_script:
    - sudo touch /etc/make.conf
    - sudo chmod 666 /etc/make.conf
    - sudo mkdir -p /usr/portage /usr/local/portage /usr/share/portage/config
    - sudo chown $USER:$USER /usr/portage /usr/local/portage /usr/share/portage/config
    - echo "PORTDIR=/usr/portage" >> /etc/make.conf
    - echo "PORTDIR_OVERLAY=/usr/local/portage" >> /etc/make.conf
    - echo 'USE="perl -python"' >> /etc/make.conf
    - wget "https://raw.githubusercontent.com/gentoo/portage/master/cnf/make.globals" -O /usr/share/portage/config/make.globals
    - wget "http://distfiles.gentoo.org/snapshots/portage-latest.tar.xz" -O /tmp/portage-latest.tar.xz
    - tar xJf /tmp/portage-latest.tar.xz -C /usr/
    - cpanm Test::CheckManifest Test::EOL   # DEV_TESTING dependencies
after_success:
    - cpanm Devel::Cover::Report::Coveralls
    - cover -test -report coveralls
#notifications:
#    irc: "chat.freenode.net#gentoo-perl"
#    on_success: change
#    on_failure: always
